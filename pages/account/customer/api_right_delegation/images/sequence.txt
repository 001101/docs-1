title Right delegation sequence

note over Developper
    As a developper, I want to create an application
    which can deploy a software stack
    on a client's account
end note

note over Developper
    I need to register my application
end note

Developper -> api.ovh.com: go to /createApp
api.ovh.com -> Developper: return a new AK / AS
Developper --> myapp.com: deploy application code with AK/AS

note over myapp.com: AK/AS are stored on the server

destroy Developper

note over Client
    As a client, I want to deploy a software stack
    on my account with one click action button
end note


note over Client, myapp.com
    browse the application catalog
    and click on 'Deploy'
end note

Client -> myapp.com: /deploy?app=XYZ

note over myapp.com
    the application needs the client's approval
    to interract with his account
end note

note left of myapp.com: request a new CK and specify a redirectionUrl
myapp.com -> api.ovh.com: /auth/credential to create a CK
api.ovh.com -> myapp.com: return a CK and validationUrl

note over myapp.com: the CK is not valid as long as the client doesn't validate it

myapp.com --> Client: redirect client to validationUrl

Client -> *OVH login form: go to validationUrl
note over OVH login form
    client authenticates itsef
    with 2FA if activated
end note
OVH login form -> api.ovh.com: validate the CK
OVH login form --> Client: redirect to redirectionUrl
destroy OVH login form

Client -> myapp.com: go to redirectionUrl

note over myapp.com: the app has now permission over parts or entire client account

loop deploy XYZ in client tenant
    myapp.com -> api.ovh.com: uses AK/AS/CK
end

#A->+B: text1
#B-->-A: text2
